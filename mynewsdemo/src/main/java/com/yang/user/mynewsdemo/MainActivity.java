package com.yang.user.mynewsdemo;import android.os.Bundle;import android.support.design.widget.NavigationView;import android.support.v4.app.FragmentActivity;import android.support.v4.app.FragmentManager;import android.support.v4.app.FragmentTransaction;import android.support.v4.widget.DrawerLayout;import android.support.v7.app.ActionBarDrawerToggle;import android.support.v7.widget.Toolbar;import android.view.KeyEvent;import android.view.MenuItem;import android.view.Window;import android.widget.Toast;import com.yang.user.mynewsdemo.ui.fragment.AboutFragment;import com.yang.user.mynewsdemo.ui.fragment.GankMainFragment;import com.yang.user.mynewsdemo.ui.fragment.GoldMainFragment;import com.yang.user.mynewsdemo.ui.fragment.LikeFragment;import com.yang.user.mynewsdemo.ui.fragment.SettingFragment;import com.yang.user.mynewsdemo.ui.fragment.VtexMainFragment;import com.yang.user.mynewsdemo.ui.fragment.WechatMainFragment;import com.yang.user.mynewsdemo.ui.fragment.ZhihuMainFragment;import javax.inject.Inject;import butterknife.BindView;import butterknife.ButterKnife;public class MainActivity extends FragmentActivity {    @BindView(R.id.drawer)    DrawerLayout mDrawwerLayout;    @BindView(R.id.toolbar)    Toolbar mToolbar;    @BindView(R.id.navigation)    NavigationView mNavigationView;    ActionBarDrawerToggle mDrawerToggle;    /**     * DrawerLayout  Fragment     */    @Inject    ZhihuMainFragment mZhihuFragment;    @Inject    GankMainFragment mGankFragment;    @Inject    WechatMainFragment mWechatFragment;    @Inject    GoldMainFragment mGoldFragment;    @Inject    VtexMainFragment mVtexFragment;    @Inject    LikeFragment mLikeFragment;    @Inject    SettingFragment mSettingFragment;    @Inject    AboutFragment mAboutFragment;    private FragmentManager fm;    private FragmentTransaction ft;    @Override    protected void onCreate(Bundle savedInstanceState) {        super.onCreate(savedInstanceState);        requestWindowFeature(Window.FEATURE_NO_TITLE);        setContentView(R.layout.activity_main);        ButterKnife.bind(this);        fm = this.getSupportFragmentManager();        mNavigationView.getMenu().findItem(R.id.drawer_zhihu).setChecked(false);        //给Toolbar加一个按钮图标        mDrawerToggle = new ActionBarDrawerToggle(this, mDrawwerLayout, mToolbar, R.string.drawer_open, R.string.drawer_close);        mDrawerToggle.syncState();        mDrawwerLayout.addDrawerListener(mDrawerToggle);        mToolbar.setTitle("知乎日报");        SelectFragment(R.id.drawer_zhihu);        mNavigationView.setCheckedItem(R.id.drawer_zhihu);        initEventAndData();    }    private void initEventAndData() {        mNavigationView.setNavigationItemSelectedListener(new NavigationView.OnNavigationItemSelectedListener() {            @Override            public boolean onNavigationItemSelected(MenuItem menuItem) {                SelectFragment(menuItem.getItemId());                mToolbar.setTitle(menuItem.getTitle());                mDrawwerLayout.closeDrawers();                return true;            }        });    }//    private void setDefaultFragment()//    {//        FragmentManager fm = getFragmentManager();//        FragmentTransaction transaction = fm.beginTransaction();//        mZhihuFragment = new ZhihuMainFragment();//        transaction.replace(R.id.Group_Lin, mZhihuFragment);//        transaction.commit();//    }    private void goneFragment() {        ft = fm.beginTransaction();        if (mZhihuFragment != null) {            ft.hide(mZhihuFragment);        }        if (mGankFragment != null) {            ft.hide(mGankFragment);        }        if (mWechatFragment != null) {            ft.hide(mWechatFragment);        }        if (mGoldFragment != null) {            ft.hide(mGoldFragment);        }        if (mVtexFragment != null) {            ft.hide(mVtexFragment);        }        if (mLikeFragment != null) {            ft.hide(mLikeFragment);        }        if (mSettingFragment != null) {            ft.hide(mSettingFragment);        }        if (mAboutFragment != null) {            ft.hide(mAboutFragment);        }        ft.commit();    }    private void SelectFragment(int id) {        goneFragment();        ft = fm.beginTransaction();        switch (id) {            case R.id.drawer_zhihu:                if (mZhihuFragment == null) {                    mZhihuFragment = new ZhihuMainFragment();                    ft.add(R.id.Group_Lin, mZhihuFragment);                } else {                    ft.show(mZhihuFragment);                }                break;            case R.id.drawer_wechat:                if (mWechatFragment == null) {                    mWechatFragment = new WechatMainFragment();                    ft.add(R.id.Group_Lin, mWechatFragment);                } else {                    ft.show(mWechatFragment);                }                break;            case R.id.drawer_gank:                if (mGankFragment == null) {                    mGankFragment = new GankMainFragment();                    ft.add(R.id.Group_Lin, mGankFragment);                } else {                    ft.show(mGankFragment);                }                break;            case R.id.drawer_gold:                if (mGoldFragment == null) {                    mGoldFragment = new GoldMainFragment();                    ft.add(R.id.Group_Lin, mGoldFragment);                } else {                    ft.show(mGoldFragment);                }                break;            case R.id.drawer_vtex:                if (mVtexFragment == null) {                    mVtexFragment = new VtexMainFragment();                    ft.add(R.id.Group_Lin, mVtexFragment);                } else {                    ft.show(mVtexFragment);                }                break;            case R.id.drawer_like:                if (mLikeFragment == null) {                    mLikeFragment = new LikeFragment();                    ft.add(R.id.Group_Lin, mLikeFragment);                } else {                    ft.show(mLikeFragment);                }                break;            case R.id.drawer_setting:                if (mSettingFragment == null) {                    mSettingFragment = new SettingFragment();                    ft.add(R.id.Group_Lin, mSettingFragment);                } else {                    ft.show(mSettingFragment);                }                break;            case R.id.drawer_about:                if (mAboutFragment == null) {                    mAboutFragment = new AboutFragment();                    ft.add(R.id.Group_Lin, mAboutFragment);                } else {                    ft.show(mAboutFragment);                }                break;        }        ft.commit();    }    private long mkeyTime = 0;    @Override    public boolean onKeyDown(int keyCode, KeyEvent event) {        if (keyCode == KeyEvent.KEYCODE_BACK) {            if ((System.currentTimeMillis() - mkeyTime) > 1000) {                mkeyTime = System.currentTimeMillis();                Toast.makeText(this, "再按一次退出应用", Toast.LENGTH_SHORT).show();            } else {                finish();                System.exit(0);            }            return false;        }        return super.onKeyDown(keyCode, event);    }}